"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[746],{1746:function(e,t,r){r.r(t),r.d(t,{default:function(){return y}});var n=r(1413),i=r(5861),s=r(885),c=r(7757),l=r.n(c),a=r(2791),o=r(1134),u=r(260),d=r(3460),p=r(6474),f=r(3705),x=function e(t){var r={};for(var n in t)if("object"!==typeof t[n]||Array.isArray(t[n]))r[n]=t[n];else{var i=e(t[n]);for(var s in i)r[n+"."+s]=i[s]}return r},m=r(732),v=r(1690),b=r(4949),h=r(2990),g=r(184);function y(e){var t=e.projectId,r=e.ticketId,c=e.onClose,y=(0,p.CG)((function(e){return e.account})).isAdmin,j=(0,a.useState)(null),w=(0,s.Z)(j,2),k=w[0],N=w[1],Z=!!k,C=(0,a.useState)(null),S=(0,s.Z)(C,2),T=S[0],R=S[1],O=!!T,I=(0,a.useState)([]),M=(0,s.Z)(I,2),L=M[0],P=M[1],V=(0,o.cI)({mode:"all"}),A=V.control,D=V.watch,B=V.handleSubmit,U=V.reset,q=V.setValue,F=V.formState.isDirty,H=D("file",null),E=(0,a.useCallback)(function(){var e=(0,i.Z)(l().mark((function e(t){var r,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.Z.Projects.listMembers(t);case 3:r=e.sent,n=r.map((function(e){return{name:e.userName,value:e.userId}})),P(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),[]),$=(0,a.useCallback)(function(){var e=(0,i.Z)(l().mark((function e(t){var r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.Z.Projects.detailsById(t);case 3:return r=e.sent,R(r),q("projectId",r.id),e.next=8,E(r.id);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),[E,q]),_=(0,a.useCallback)(function(){var e=(0,i.Z)(l().mark((function e(t){var r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.Z.Tickets.details(t);case 3:r=e.sent,N(r),console.log("ticket",r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),[]);(0,a.useEffect)((function(){t&&$(t)}),[$,t]),(0,a.useEffect)((function(){r&&_(r)}),[_,r]),(0,a.useEffect)((function(){return!k||H||F||U(k),function(){H&&URL.revokeObjectURL(H.preview)}}),[F,U,k,H]);var z=function(e,t){q(e,t)};function G(){return(G=(0,i.Z)(l().mark((function e(t){var r,i,s,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=2;break}return e.abrupt("return");case 2:if(r=t.file,i=t.description,s={id:k?k.id:0,subject:t.subject,body:t.body,priority:t.priority,projectId:T.id,status:t.status,assignedMemberId:t.assignedMemberId,description:i},a=(0,n.Z)((0,n.Z)({},x(s)),{},{"description.file":r}),T){e.next=7;break}return e.abrupt("return");case 7:if(e.prev=7,!Z){e.next=11;break}return e.next=11,u.Z.Tickets.update(a);case 11:if(Z){e.next=14;break}return e.next=14,u.Z.Tickets.create(a);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(7),console.log(e.t0);case 19:return e.prev=19,c(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[7,16,19,22]])})))).apply(this,arguments)}return(0,g.jsx)("div",{className:"lg:fixed top-0 left-0 h-full min-h-screen w-screen bg-slate-100 z-[5] px-5 lg:px-0 flex items-center  py-20",children:(0,g.jsxs)("div",{className:"container mx-auto flex flex-col max-w-4xl",children:[(0,g.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between border-b border-b-white py-1 lg:items-end ",children:[(0,g.jsx)("p",{className:"font-Oswald text-5xl uppercase",children:Z?"Edit Ticket":"New Ticket"}),(0,g.jsx)("p",{className:"font-Oswald text-xl uppercase font-thin",children:null===T||void 0===T?void 0:T.title})]}),(0,g.jsxs)("form",{onSubmit:B((function(e){return G.apply(this,arguments)})),className:"w-full flex flex-col gap-y-5",children:[(0,g.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 text-black  lg:gap-x-10",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-y-5 py-5",children:[(0,g.jsx)(h.Z,{type:"text",control:A,label:"Ticket Title",placeholder:"Ticket Title",name:"subject",rules:{required:"Subject is required"}}),(0,g.jsx)(h.Z,{type:"text",control:A,label:"Operating System",placeholder:"Operating System",name:"description.operatingSystem"}),(0,g.jsx)(h.Z,{type:"text",control:A,label:"Browser",placeholder:"Browser",name:"description.browser"}),(0,g.jsx)(b.Z,{rows:7,type:"text",control:A,label:"Ticket Description",placeholder:"Ticket Description",name:"body",rules:{required:"Description is required"}})]}),(0,g.jsx)("div",{className:"flex flex-col gap-y-5 py-5",children:(0,g.jsxs)("div",{className:" w-full flex flex-col  gap-y-5 ",children:[Z&&(k.isAssigned||(null===T||void 0===T?void 0:T.isLeader))&&(0,g.jsx)(m.Z,{title:"Priority",items:(0,f.S)(d.Bh),onChange:function(e){return z("priority",e)},selectedValue:null===k||void 0===k?void 0:k.priority}),Z&&(k.isAssigned||(null===T||void 0===T?void 0:T.isLeader))&&(0,g.jsx)(m.Z,{title:"Status",items:(0,f.S)(d.mk),onChange:function(e){return z("status",e)},selectedValue:null===k||void 0===k?void 0:k.status}),Z&&(y||(null===T||void 0===T?void 0:T.isLeader))&&(0,g.jsx)(m.Z,{title:"Assigned Member",items:L,onChange:function(e){return z("assignedMemberId",e)},selectedValue:null===k||void 0===k?void 0:k.assignedMember}),(0,g.jsx)(m.Z,{title:"Occurrence",items:(0,f.S)(d.vH),onChange:function(e){return z("description.occurrence",e)},selectedValue:null===k||void 0===k?void 0:k.description.occurrence}),(0,g.jsx)(m.Z,{title:"Severity",items:(0,f.S)(d._8),onChange:function(e){return z("description.severity",e)},selectedValue:null===k||void 0===k?void 0:k.description.severity}),(0,g.jsx)(m.Z,{title:"Nature",items:(0,f.S)(d.$p),onChange:function(e){return z("description.nature",e)},selectedValue:null===k||void 0===k?void 0:k.description.nature})]})})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-x-10 lg:h-[200px]",children:[(0,g.jsx)("div",{className:"h-auto border-x-2 px-5 py-5 border-x-white text-white bg-slate-500 bg-opacity-50 flex-auto",children:(0,g.jsx)(v.Z,{control:A,name:"file"})}),(0,g.jsx)("div",{className:"flex flex-row h-full w-full border-x-2 px-5 border-x-white text-white bg-slate-500 bg-opacity-50",children:(0,g.jsx)("div",{className:" mx-auto flex items-center justify-center",children:H?(0,g.jsx)("img",{className:" object-auto w-auto object-center max-h-[200px]",src:H.preview,alt:"preview"}):(0,g.jsx)("img",{className:" object-auto w-auto object-center max-h-[200px]",src:null===k||void 0===k?void 0:k.description.photo,alt:null===k||void 0===k?void 0:k.subject})})})]}),(0,g.jsxs)("div",{className:"flex flex-row gap-x-0 mx-auto w-full justify-center lg:justify-end py-5",children:[(0,g.jsx)("input",{className:"cursor-pointer border-slate-800 border-2 text-slate-800 py-1 px-5 uppercase font-Oswald text-xl font-thin",type:"button",value:"Cancel",onClick:c}),(0,g.jsx)("input",{className:"cursor-pointer bg-slate-800 text-white py-1 px-5 uppercase font-Oswald text-xl font-thin",type:"submit",value:Z?"Update Ticket":"Create Ticket"})]})]})]})})}},3460:function(e,t,r){var n,i,s,c,l;r.d(t,{vH:function(){return n},mk:function(){return i},Bh:function(){return s},_8:function(){return c},$p:function(){return l}}),function(e){e[e.Persistent=0]="Persistent",e[e.Frequent=1]="Frequent",e[e.Random=2]="Random",e[e.Rare=3]="Rare"}(n||(n={})),function(e){e[e.New=0]="New",e[e.Assigned=1]="Assigned",e[e.Open=2]="Open",e[e.Fixed=3]="Fixed",e[e.Pending=4]="Pending",e[e.Retest=5]="Retest",e[e.Verified=6]="Verified",e[e.Reopen=7]="Reopen",e[e.Closed=8]="Closed",e[e.Duplicate=9]="Duplicate",e[e.Rejected=10]="Rejected",e[e.Deferred=11]="Deferred",e[e.NotBug=12]="NotBug"}(i||(i={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High",e[e.Urgent=3]="Urgent"}(s||(s={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High",e[e.Critical=3]="Critical"}(c||(c={})),function(e){e[e.Functional=0]="Functional",e[e.Performance=1]="Performance",e[e.Usability=2]="Usability",e[e.Compatibility=3]="Compatibility",e[e.Security=4]="Security"}(l||(l={}))},3705:function(e,t,r){r.d(t,{S:function(){return i}});var n=r(885);function i(e){for(var t=[],r=0,i=Object.entries(e);r<i.length;r++){var s=(0,n.Z)(i[r],2),c=s[0],l=s[1];Number.isNaN(Number(c))&&t.push({name:c,value:l})}return t}}}]);
//# sourceMappingURL=746.396d3791.chunk.js.map